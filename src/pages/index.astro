---
import "../styles/global.css";
import Topbar from "../components/Topbar.astro";
const BASE = import.meta.env.BASE_URL;
---

<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href={`${BASE}favicon.svg`} />
    <link rel="shortcut icon" type="image/svg+xml" href={`${BASE}favicon.svg`} />
    <title>alive</title>
  </head>
  <body>
    <header class="topbar">
      <div class="site-title">alive</div>
      <button id="toggleTheme" class="invert-btn" aria-pressed="false" aria-label="Invert site">
        invert
      </button>
    </header>

    <main class="wrap">
      <h1>Hi, I'm Alive</h1>
      <p>I'm a Junior in high school, and I create stuff</p>

      <section>
        <h2>my socials</h2>

        <div class="row">
          <div class="label">github</div>
          <div class="value">
            <div class="repeat-line">
              {Array.from({ length: 24 }).map((_, i) => (
                <span class="repeat-item" key={i}>
                  https://github.com/ChanminK{ i < 23 ? "  â€¢  " : "" }
                </span>
              ))}
            </div>
          </div>
        </div>

        <div class="row">
          <div class="label">slack</div>
          <div class="value">@Iamalive</div>
        </div>

        <div class="row">
          <div class="label">email</div>
          <div class="value">thisischanmin.gmail.com</div>
        </div>
      </section>
    </main>

    <script is:inline>
      const root = document.documentElement;
      const key = 'theme';
	  const BASE = `${BASE}`;

      const saved = localStorage.getItem(key);
      if (saved === 'light' || saved === 'dark') root.dataset.theme = saved;

      function setIcon() {
        const isLight = root.dataset.theme === 'light';
        const file = isLight ? 'faviconinvert.svg' : 'favicon.svg';
        const href = BASE + file + '?v=' + (isLight ? '1' : '0'); // cache-bust

        document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]').forEach(link => {
          link.setAttribute('type', 'image/svg+xml');
          link.setAttribute('href', href);
        });
      }
      setIcon();

      const btn = document.getElementById('toggleTheme');
      btn?.addEventListener('click', () => {
        const next = root.dataset.theme === 'dark' ? 'light' : 'dark';
        root.dataset.theme = next;
        localStorage.setItem(key, next);
        btn.setAttribute('aria-pressed', String(next === 'light'));
        setIcon();
      });
    </script>
  </body>
</html>

