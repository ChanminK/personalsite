---
const BASE = import.meta.env.BASE_URL; 
const links = [
  { href: "/", label: "home" },
  { href: "/projects", label: "my projects" },
  { href: "/logbook", label: "logbook" },
];
---

<header class="topbar">
  <nav class="tabs">
    {links.map(l => (
      <a href={l.href} class="tab">{l.label}</a>
    ))}
  </nav>
  <button id="toggleTheme" class="invert-btn" aria-pressed="false" aria-label="Invert site">invert</button>
</header>

<script is:inline>
  const BASE = "${BASE}";
  const root = document.documentElement;
  const KEY = 'theme';

  const saved = localStorage.getItem(KEY);
  if (saved === 'light' || saved === 'dark') root.dataset.theme = saved;

  function setIcon() {
    const isLight = root.dataset.theme === 'light';
    const file = isLight ? 'faviconinvert.svg' : 'favicon.svg';
    const href = BASE + file + '?v=' + (isLight ? '1' : '0');
    document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]').forEach(link => {
      link.setAttribute('type', 'image/svg+xml');
      link.setAttribute('href', href);
    });
  }
  setIcon();

  const btn = document.getElementById('toggleTheme');
  btn?.addEventListener('click', () => {
    const next = root.dataset.theme === 'dark' ? 'light' : 'dark';
    root.dataset.theme = next;
    localStorage.setItem(KEY, next);
    btn.setAttribute('aria-pressed', String(next === 'light'));
    setIcon();
  });
</script>